<!doctype html>
<html lang="en">
  <head>
    <link rel="stylesheet" href="https://unpkg.com/ol@latest/ol.css" type="text/css">
    <!--<link rel="stylesheet" href="./ol.css" type="text/css">-->
    <script src="https://unpkg.com/ol@latest/dist/ol.js"></script>
    <!--<script src="./ol.js"></script>-->
    <title>Maps2Zim PoC</title>
    <style> 
        #map {
            height: 600px;
            width: 100%;
        }	
    </style>
  </head>
  <body>
    <h2>Maps2Zim PoC</h2>
    <div id="map" class="map"></div>
  </body> 
  <script>

class CustomImageTile extends ol.ImageTile {
    constructor(tileCoord, state, src, crossOrigin, tileLoadFunction) {
        super(tileCoord, state, src, crossOrigin, tileLoadFunction);
    }
}

// Custom tile image source
const customTileSource = new ol.source.TileImage({
    tileGrid: ol.tilegrid.createXYZ({ tileSize: 256 }),
    tileLoadFunction: (imageTile, src) => {
        imageTile.getImage().src = src;
    },
    tileClass: CustomImageTile,
    url: (tileCoord) => {
        if (!tileCoord) return '';
        const z = tileCoord[0];
        const x = tileCoord[1];
        const y = -tileCoord[2] - 1; // Convert from TMS to XYZ
        return `./tiles/${z}/${x}/${y}.png`;
    }
});

// Create a tile layer with the custom source
const tileLayer = new ol.layer.Tile({
    source: customTileSource
});

// Initialize the map
const map = new ol.Map({
    target: 'map',
    layers: [tileLayer],
    view: new ol.View({
        center: ol.proj.fromLonLat([0, 0]), // Center at longitude 0, latitude 0
        zoom: 2
    })
});


  </script>
  
</html>